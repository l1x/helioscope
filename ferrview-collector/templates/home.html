{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block styles %}
/* Header */
header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 24px;
    padding-bottom: 20px;
    border-bottom: 1px solid var(--separator);
}
header h1 {
    color: var(--accent);
    font-size: 1.5rem;
    font-weight: 700;
}

/* Nodes Grid */
.nodes-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 16px;
}
@media (min-width: 600px) {
    .nodes-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}
@media (min-width: 1200px) {
    .nodes-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

/* Node Card */
.node-card {
    background: var(--bg-card);
    border-radius: var(--border-radius);
    padding: 20px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    display: flex;
    flex-direction: column;
    gap: 16px;
}
.node-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
}

.node-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}
.node-header h3 {
    color: var(--text-primary);
    font-size: 1.1rem;
    font-weight: 600;
    cursor: help;
}

.node-metrics {
    padding: 16px 0;
    border-top: 1px solid var(--separator);
    border-bottom: 1px solid var(--separator);
}

.node-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: var(--text-secondary);
    font-size: 0.8rem;
}
.node-meta span {
    display: flex;
    align-items: center;
    gap: 4px;
}

.node-actions {
    margin-top: auto;
}
.node-actions .btn {
    width: 100%;
}

/* Empty State */
.no-data {
    background: var(--bg-card);
    border-radius: var(--border-radius);
    padding: 60px 20px;
    text-align: center;
    color: var(--text-secondary);
}
.no-data p {
    font-size: 1rem;
}

/* Mobile adjustments */
@media (max-width: 430px) {
    header {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
    }
    .node-card {
        padding: 16px;
    }
}
{% endblock %}

{% block content %}
        <header>
            <h1>ferrview</h1>
            <div class="metric-row">
                <div class="metric-item">
                    <span class="metric-value">{{ nodes.len() }}</span>
                    <span class="metric-label">Nodes</span>
                </div>
                <div class="separator"></div>
                <div class="metric-item">
                    <span class="metric-value status-active">‚óè</span>
                    <span class="metric-label">Running</span>
                </div>
            </div>
        </header>
{% if nodes.is_empty() %}
        <div class="no-data">
            <p>No nodes detected yet. Waiting for metrics...</p>
        </div>
{% else %}
        <div class="nodes-grid">
{% for node in nodes %}
            <div class="node-card">
                <div class="node-header">
                    <h3 title="{{ node.node_id }}">{% match node.hostname %}{% when Some with (h) %}{{ h }}{% when None %}{{ node.node_id|shorten_uuid }}{% endmatch %}</h3>
                    <span class="status-badge">Active</span>
                </div>
                <div class="node-metrics">
                    <div class="metric-row center">
                        <div class="metric-item">
                            <span class="metric-value">{% match node.cpu_cores %}{% when Some with (c) %}{{ c }}{% when None %}--{% endmatch %}</span>
                            <span class="metric-label">Cores</span>
                        </div>
                        <div class="separator"></div>
                        <div class="metric-item">
                            <span class="metric-value">{{ node.memory_total_gb|format_memory }}</span>
                            <span class="metric-label">Memory</span>
                        </div>
                        <div class="separator"></div>
                        <div class="metric-item">
                            <span class="metric-value">{{ node.max_temp_celsius|format_temp }}</span>
                            <span class="metric-label">Max Temp</span>
                        </div>
                    </div>
                </div>
                <div class="node-meta">
                    <span>{% match node.cpu_arch %}{% when Some with (a) %}{{ a }}{% when None %}--{% endmatch %}</span>
                    <span>{{ node.last_seen|format_timestamp }}</span>
                </div>
                <div class="node-actions">
                    <a href="/ui/node/{{ node.node_id }}" class="btn btn-primary">View Node</a>
                </div>
            </div>
{% endfor %}
        </div>
{% endif %}
{% endblock %}
